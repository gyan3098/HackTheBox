┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #ls                                
hosts.txt  nmap                         
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #vi /etc/hosts                     
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #cat /etc/hosts                    
??? from here until ???END lines may have been inserted/deleted                  
127.0.0.1       localhost               
127.0.1.1       parrot                  
10.10.10.22     GET / HTTP/1.1          
10.10.10.17     www.brainfuck.htb brainfuck.htb sup3rs3cr3t.brainfuck.htb        

If-Modified-Since: Wed, 26 Jul 2017 22:36:0                                      
#10.10.10.22    admin-portal.europacorp.htb                                      
# The following lines are desirable for IPv6 capable hosts                       
::1     localhost ip6-localhost ip6-loopback                                     
ff02::1 ip6-allnodes                    
ff02::2 ip6-allrouters                  
???END                                  
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #wpscan -u https://brainfuck.htb --disable-tls-checks                       

Scan Aborted: invalid option: -u        
┌─[✗]─[root@parrot]─[~/hackthebox/brainfuck]                                     
└──╼ #wpscan -h                         
_______________________________________________________________                  
         __          _______   _____    
         \ \        / /  __ \ / ____|   
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®                           
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \                            
            \  /\  /  | |     ____) | (__| (_| | | | |                           
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|                           

         WordPress Security Scanner by the WPScan Team                           
                         Version 3.7.5  
       Sponsored by Automattic - https://automattic.com/                         
       @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_                         
_______________________________________________________________                  

Usage: wpscan [options]                 
        --url URL                                 The URL of the blog to scan    
                                                  Allowed Protocols: http, https 
                                                  Default Protocol if none provided: http                                                                         
                                                  This option is mandatory unless update or help or hh or version is/are supplied                                 
    -h, --help                                    Display the simple help and exit                                                                                
        --hh                                      Display the full help and exit 
        --version                                 Display the version and exit   
    -v, --verbose                                 Verbose mode                   
        --[no-]banner                             Whether or not to display the banner                                                                            
                                                  Default: true                  
    -o, --output FILE                             Output to FILE                 
    -f, --format FORMAT                           Output results in the format supplied                                                                           
                                                  Available choices: cli, cli-no-color, json, cli-no-colour                                                       
        --detection-mode MODE                     Default: mixed                 
                                                  Available choices: mixed, passive, aggressive                                                                   
        --user-agent, --ua VALUE        
        --random-user-agent, --rua                Use a random user-agent for each scan                                                                           
        --http-auth login:password      
    -t, --max-threads VALUE                       The max threads to use         
                                                  Default: 5                     
        --throttle MilliSeconds                   Milliseconds to wait before doing another web request. If used, the max threads will be set to 1.               
        --request-timeout SECONDS                 The request timeout in seconds 
                                                  Default: 60                    
        --connect-timeout SECONDS                 The connection timeout in seconds                                                                               
                                                  Default: 30                    
        --disable-tls-checks                      Disables SSL/TLS certificate verification, and downgrade to TLS1.0+ (requires cURL 7.66 for the latter)         
        --proxy protocol://IP:port                Supported protocols depend on the cURL installed                                                                
        --proxy-auth login:password     
        --cookie-string COOKIE                    Cookie string to use in requests, format: cookie1=value1[; cookie2=value2]                                      
        --cookie-jar FILE-PATH                    File to read and write cookies 
                                                  Default: /tmp/wpscan/cookie_jar.txt                                                                             
        --force                                   Do not check if the target is running WordPress                                                                 
        --[no-]update                             Whether or not to update the Database                                                                           
        --api-token TOKEN                         The WPVulnDB API Token to display vulnerability data                                                            
        --wp-content-dir DIR                      The wp-content directory if custom or not detected, such as "wp-content"                                        
        --wp-plugins-dir DIR                      The plugins directory if custom or not detected, such as "wp-content/plugins"                                   
    -e, --enumerate [OPTS]                        Enumeration Process            
                                                  Available Choices:             
                                                   vp   Vulnerable plugins       
                                                   ap   All plugins              
                                                   p    Popular plugins          
                                                   vt   Vulnerable themes        
                                                   at   All themes               
                                                   t    Popular themes           
                                                   tt   Timthumbs                
                                                   cb   Config backups           
                                                   dbe  Db exports               
                                                   u    User IDs range. e.g: u1-5                                                                                 
                                                        Range separator to use: '-'                                                                               
                                                        Value if no argument supplied: 1-10                                                                       
                                                   m    Media IDs range. e.g m1-15                                                                                
                                                        Note: Permalink setting must be set to "Plain" for those to be detected                                   
                                                        Range separator to use: '-'                                                                               
                                                        Value if no argument supplied: 1-100                                                                      
                                                  Separator to use between the values: ','                                                                        
                                                  Default: All Plugins, Config Backups                                                                            
                                                  Value if no argument supplied: vp,vt,tt,cb,dbe,u,m                                                              
                                                  Incompatible choices (only one of each group/s can be used):                                                    
                                                   - vp, ap, p                   
                                                   - vt, at, t                   
        --exclude-content-based REGEXP_OR_STRING  Exclude all responses matching the Regexp (case insensitive) during parts of the enumeration.                   
                                                  Both the headers and body are checked. Regexp delimiters are not required.                                      
        --plugins-detection MODE                  Use the supplied mode to enumerate Plugins, instead of the global (--detection-mode) mode.                      
                                                  Default: passive               
                                                  Available choices: mixed, passive, aggressive                                                                   
        --plugins-version-detection MODE          Use the supplied mode to check plugins versions instead of the --detection-mode or --plugins-detection modes.   
                                                  Default: mixed                 
                                                  Available choices: mixed, passive, aggressive                                                                   
    -P, --passwords FILE-PATH                     List of passwords to use during the password attack.                                                            
                                                  If no --username/s option supplied, user enumeration will be run.                                               
    -U, --usernames LIST                          List of usernames to use during the password attack.                                                            
                                                  Examples: 'a1', 'a1,a2,a3', '/tmp/a.txt'                                                                        
        --multicall-max-passwords MAX_PWD         Maximum number of passwords to send by request with XMLRPC multicall                                            
                                                  Default: 500                   
        --password-attack ATTACK                  Force the supplied attack to be used rather than automatically determining one.                                 
                                                  Available choices: wp-login, xmlrpc, xmlrpc-multicall                                                           
        --stealthy                                Alias for --random-user-agent --detection-mode passive --plugins-version-detection passive                      

[!] To see full list of options use --hh.                                        
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #wpscan https://brainfuck.htb --disable-tls-checks                                                                                                           
One of the following options is required: url, update, help, hh, version         

Please use --help/-h for the list of available options.                          
┌─[✗]─[root@parrot]─[~/hackthebox/brainfuck]                                     
└──╼ #wpscan --url https://brainfuck.htb --disable-tls-checks                                                                                                     
_______________________________________________________________                  
         __          _______   _____    
         \ \        / /  __ \ / ____|   
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®                           
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \                            
            \  /\  /  | |     ____) | (__| (_| | | | |                           
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|                           

         WordPress Security Scanner by the WPScan Team                           
                         Version 3.7.5  
       Sponsored by Automattic - https://automattic.com/                         
       @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_                         
_______________________________________________________________                  

[+] URL: https://brainfuck.htb/         
[+] Started: Sat Jan  4 19:31:55 2020   

Interesting Finding(s):                 

[+] https://brainfuck.htb/              
 | Interesting Entry: Server: nginx/1.10.0 (Ubuntu)                              
 | Found By: Headers (Passive Detection)                                         
 | Confidence: 100%                     

[+] https://brainfuck.htb/xmlrpc.php    
 | Found By: Direct Access (Aggressive Detection)                                
 | Confidence: 100%                     
 | References:                          
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API                            
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner                                                                            
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos  
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login                                                                             
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access                                                                          

[+] https://brainfuck.htb/readme.html   
 | Found By: Direct Access (Aggressive Detection)                                
 | Confidence: 100%                     

[+] https://brainfuck.htb/wp-cron.php   
 | Found By: Direct Access (Aggressive Detection)                                
 | Confidence: 60%                      
 | References:                          
 |  - https://www.iplocation.net/defend-wordpress-from-ddos                      
 |  - https://github.com/wpscanteam/wpscan/issues/1299                           

[+] WordPress version 4.7.3 identified (Insecure, released on 2017-03-06).       
 | Found By: Rss Generator (Passive Detection)                                   
 |  - https://brainfuck.htb/?feed=rss2, <generator>https://wordpress.org/?v=4.7.3</generator>                                                                     
 |  - https://brainfuck.htb/?feed=comments-rss2, <generator>https://wordpress.org/?v=4.7.3</generator>                                                            

[+] WordPress theme in use: proficient  
 | Location: https://brainfuck.htb/wp-content/themes/proficient/                 
 | Last Updated: 2019-12-27T00:00:00.000Z                                        
 | Readme: https://brainfuck.htb/wp-content/themes/proficient/readme.txt         
 | [!] The version is out of date, the latest version is 3.0.6                   
 | Style URL: https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3                                                                              
 | Style Name: Proficient               
 | Description: Proficient is a Multipurpose WordPress theme with lots of powerful features, instantly giving a prof...                                           
 | Author: Specia                       
 | Author URI: https://speciatheme.com/ 
 |                                      
 | Found By: Css Style In Homepage (Passive Detection)                           
 |                                      
 | Version: 1.0.6 (80% confidence)      
 | Found By: Style (Passive Detection)  
 |  - https://brainfuck.htb/wp-content/themes/proficient/style.css?ver=4.7.3, Match: 'Version: 1.0.6'                                                             

[+] Enumerating All Plugins (via Passive Methods)                                
[+] Checking Plugin Versions (via Passive and Aggressive Methods)                

[i] Plugin(s) Identified:               

[+] wp-support-plus-responsive-ticket-system                                     
 | Location: https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/                                                                   
 | Last Updated: 2019-09-03T07:57:00.000Z                                        
 | [!] The version is out of date, the latest version is 9.1.2                   
 |                                      
 | Found By: Urls In Homepage (Passive Detection)                                
 |                                      
 | Version: 7.1.3 (100% confidence)     
 | Found By: Readme - Stable Tag (Aggressive Detection)                          
 |  - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt                                                                
 | Confirmed By: Readme - ChangeLog Section (Aggressive Detection)               
 |  - https://brainfuck.htb/wp-content/plugins/wp-support-plus-responsive-ticket-system/readme.txt                                                                

[+] Enumerating Config Backups (via Passive and Aggressive Methods)              
 Checking Config Backups - Time: 00:00:02 <=====================================================================================> (21 / 21) 100.00% Time: 00:00:02

[i] No Config Backups Found.            

[!] No WPVulnDB API Token given, as a result vulnerability data has not been output.                                                                              
[!] You can get a free API token with 50 daily requests by registering at https://wpvulndb.com/users/sign_up.                                                     

[+] Finished: Sat Jan  4 19:33:01 2020  
[+] Requests Done: 53                   
[+] Cached Requests: 5                  
[+] Data Sent: 11.692 KB                
[+] Data Received: 161.223 KB           
[+] Memory used: 162.92 MB              
[+] Elapsed time: 00:01:05              
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #searchsploit wp-support-plus      
Exploits: No Result                     
Shellcodes: No Result                   
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #searchsploit wp support plus                                                                                                                                
------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
 Exploit Title                                                                                                           |  Path                                  
                                                                                                                         | (/usr/share/exploitdb/)                
------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
WordPress Plugin WP Support Plus Responsive Ticket System 2.0 - Multiple Vulnerabilities                                 | exploits/php/webapps/34589.txt         
WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - Privilege Escalation                                   | exploits/php/webapps/41006.txt         
WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - SQL Injection                                          | exploits/php/webapps/40939.txt         
------------------------------------------------------------------------------------------------------------------------- ----------------------------------------
Shellcodes: No Result                   
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #searchsploit -x exploits/php/webapps/41006.txt                             
  Exploit: WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - Privilege Escalation                                                                 
      URL: https://www.exploit-db.com/exploits/41006                             
     Path: /usr/share/exploitdb/exploits/php/webapps/41006.txt                   
File Type: ASCII text, with CRLF line terminators                                



┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #searchsploit -x exploits/php/webapps/41006.txt                             
  Exploit: WordPress Plugin WP Support Plus Responsive Ticket System 7.1.3 - Privilege Escalation                                                                 
      URL: https://www.exploit-db.com/exploits/41006                             
     Path: /usr/share/exploitdb/exploits/php/webapps/41006.txt                   
File Type: ASCII text, with CRLF line terminators                                



┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #vim exploit.html                  

[1]+  Stopped                 vim exploit.html                                   
┌─[✗]─[root@parrot]─[~/hackthebox/brainfuck]                                     
└──╼ #vim exploit.html                  
┌─[✗]─[root@parrot]─[~/hackthebox/brainfuck]                                     
└──╼ #ls -la                            
total 16                                
drwxr-xr-x  3 root root 4096 Dec 28 21:20 .                                      
drwxr-xr-x 26 root root 4096 Jan  4 07:06 ..                                     
-rw-r--r--  1 root root   59 Dec 28 21:20 hosts.txt                              
drwxr-xr-x  2 root root 4096 Dec 28 21:16 nmap                                   
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #rm exploit.html                   
rm: cannot remove 'exploit.html': No such file or directory                      
┌─[✗]─[root@parrot]─[~/hackthebox/brainfuck]                                     
└──╼ #vim exploit.html                  
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #ls                                
exploit.html  hosts.txt  nmap           
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #vim exploit.html                  
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #python -m SimpleHTTPServer        
Serving HTTP on 0.0.0.0 port 8000 ...   
127.0.0.1 - - [04/Jan/2020 20:04:34] "GET / HTTP/1.1" 200 -                      
127.0.0.1 - - [04/Jan/2020 20:04:35] code 404, message File not found            
127.0.0.1 - - [04/Jan/2020 20:04:35] "GET /favicon.ico HTTP/1.1" 404 -           
127.0.0.1 - - [04/Jan/2020 20:04:38] "GET /exploit.html HTTP/1.1" 200 -          
^CTraceback (most recent call last):    
  File "/usr/lib/python2.7/runpy.py", line 174, in _run_module_as_main           
    "__main__", fname, loader, pkg_name)                                         
  File "/usr/lib/python2.7/runpy.py", line 72, in _run_code                      
    exec code in run_globals            
  File "/usr/lib/python2.7/SimpleHTTPServer.py", line 235, in <module>           
    test()                              
  File "/usr/lib/python2.7/SimpleHTTPServer.py", line 231, in test               
    BaseHTTPServer.test(HandlerClass, ServerClass)                               
  File "/usr/lib/python2.7/BaseHTTPServer.py", line 610, in test                 
    httpd.serve_forever()               
  File "/usr/lib/python2.7/SocketServer.py", line 231, in serve_forever          
    poll_interval)                      
  File "/usr/lib/python2.7/SocketServer.py", line 150, in _eintr_retry           
    return func(*args)                  
KeyboardInterrupt                       
┌─[✗]─[root@parrot]─[~/hackthebox/brainfuck]                                     
└──╼ #vi creds                          
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #cat creds                         
SMTP Credential                         
username: orestis                       
password : kHGuERB29DNiNEd              
┌─[root@parrot]─[~/hackthebox/brainfuck]
└──╼ #                                      
